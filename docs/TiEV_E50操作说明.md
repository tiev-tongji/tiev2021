# TiEV E50操作说明
Author 赵君峤
Date 2017.11

# 综述
途灵TiEV智能无人车电动车基于上汽荣威E50车型开发而成，其中主要包括以下三个系统部分：
- 车辆底盘控制：E50车辆控制器，ESP控制器与电机
- 传感器系统：包括定位系统（GPS接收机、惯性导航系统），激光雷达系统（64线雷达，16线雷达，4线/8线雷达，1线雷达），视觉系统（单目相机，立体相机，环视相机），毫米波雷达系统（前视ESR，侧后视RSDS）
- 控制器系统：包括工控机，jetson-TX2，以及开关控制盒对电气系统进行控制

# IP配置
- 子网掩码 24，默认网关 192.168.0.23
- Linux工控机 IP 192.168.222.1 (交换机) |HDL64|SICK|LUX|IMU| DHCP WIFI
- !Windows工控机(输出RTK，2016代码，默认网关) IP 192.168.0.23 (交换机) | DHCP HUAWEI
- Linux工控机(视觉) IP 192.168.222.2 (交换机) | IP 192.168.0.188(相机)
- Linux嵌入式控制器(TX2) IP 192.168.222.110 (交换机)
- SICK雷达(前) IP 192.168.222.22 (交换机)
- SICK雷达(后) IP 192.168.222.11 (交换机)
- LUX 雷达 IP 192.168.0.10 (交换机)
- HDL64 雷达 IP 192.168.1.x (Linux工控机)
- baslar 相机 IP 192.168.0.123
- RT2000 惯导 IP 109.168.0.8

# 用户名密码
- Linux工控机 autolab tjlab222
- Linux工控机 autolab tjlab222
- TX2嵌入式控制器 autolab tjlab222 | su autolab 

# 操作流程
1. 上车前首先确认：是否连接充电枪，轮胎是否缺气，外观是否损坏
2. 连接电瓶：汽车前舱电瓶在车辆停止时均需断开，因此首先连接电瓶（12v对人体安全），其中ESP供电电瓶位于副驾驶座 CAUTION：正负极一定不能错误，否则损坏车辆设备！
3. 插入车钥匙：需听到嘀嘀嘀三声，并仪表盘显示ready闪烁后方为启动成功，否则请参见Q&A1
4. 打开后备箱开关控制盒总开关，并打开相应设备电源：如按键灯亮则供电成功，否则请参见Q&A3
5. 打开工控机以及TX2电源：工控机电源开关亮黄色灯，启动为绿色灯，TX2电源开关位于下方中间，启动后亮绿色灯。
6. 显示切换器切换到Windows下，启动enginuity检查惯导是否自动弹出ip地址，否则请参见Q&A4
7. 打开无线网卡，启动NTRIPClient无线差分信号接收软件，检查是否接收正确发送正确。
8. 启动车辆加速至25kph并保持，直到enginuity显示车速并RTK_INTEGER 或RTK_FLOAT。
9. 关闭enginuity，切换至工控机，启动应用程序
10. 完成调试后首先退出应用程序，然后关闭操作系统并关机，然后利用开关控制盒切断所有开关，最后关闭总开关
11. 将车辆锁好，断开副驾驶蓄电池正极，断开前舱蓄电池正极，进行充电

# Q&A
1. 车钥匙插入后听不到嘀嘀嘀，以及仪表盘ready不显示，或方向盘锁死。
A. 重新尝试上述过程，如连续三次无法成功，需参照用户手册检查手套箱中保险丝；如仍未解决，需继续检查前舱保险丝盒。
2. 车门用遥控钥匙无法打开
A. 检查前舱电瓶是否亏电（<11v）,用搭火线连接其他电瓶与本车电瓶并进行尝试。CAUTION：正负极一定不能接错，否则损坏车辆设备！ 如前舱无法打开，需使用机械钥匙打开车门，机械钥匙旋转力度不能过重。
3. 控制盒灯不亮
A. 检查对应设备的供电插头是否链接正确的供电线路，如连接正确，则需拆开控制盒检查保险丝。
4. 惯导无法连接
A. 检查惯导设备指示灯以及GPS接收机灯是否正常闪烁，如不亮需检查供电
5. 惯导数据异常
A. 将惯导断电重连
6 .LCM在网络正常连通情况下不能正常工作
A .在程序中初始化lcm对象时需要指定组播地址以及ttl(updm),另外在系统设置中需要添加路由,其中：
	linux：
		见官方文档
	windows：
		route add -p 224.0.0.0 mask 240.0.0.0 [网关] metric 1 if [相应网卡接口id] 
		其中相应网卡接口id可以用route print命令查看
